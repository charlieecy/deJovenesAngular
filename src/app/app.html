<div id="cuerpo">
  <form [formGroup]="miFormulario" (ngSubmit)="enviarFormulario()">

    <div class="fila">
      <div class="columna">
        <label>Nombre</label><br />
        <input class="caja" type="text" formControlName="nombre" placeholder="Escriba aquí su nombre" maxlength="100" />
        @if (miFormulario.get('nombre')?.touched && miFormulario.get('nombre')?.invalid) {
          <p class="obligatorio" style="display: block;">El nombre es obligatorio (2-60 caracteres)</p>
        }
      </div>

      <div class="columna">
        <label>Apellidos</label><br />
        <input class="caja" formControlName="apellidos" type="text" placeholder="Escriba aquí sus apellidos" maxlength="100" />
        @if (miFormulario.get('apellidos')?.touched && miFormulario.get('apellidos')?.invalid) {
          <p class="obligatorio" style="display: block;">Los apellidos son obligatorios (2-80 caracteres)</p>
        }
      </div>
    </div>

    <div class="fila">
      <div class="columna">
        <label>DNI</label><br />
        <input class="caja" formControlName="DNI" type="text" placeholder="LLLLLLLLN" maxlength="9" />
        @if (miFormulario.get('DNI')?.touched && miFormulario.get('DNI')?.invalid) {
          <p class="obligatorio" style="display: block;">El DNI es obligatorio y debe ser válido</p>
        }
      </div>

      <div class="columna">
        <label>Fecha de nacimiento</label><br />
        <input class="caja" formControlName="fechaNacimiento" type="text" placeholder="DD/MM/YYYY" maxlength="10" />
        @if (miFormulario.get('fechaNacimiento')?.touched && miFormulario.get('fechaNacimiento')?.invalid) {
          <p class="obligatorio" style="display: block;">Formato de fecha incorrecto (DD/MM/YYYY)</p>
        }
      </div>
    </div>

    <div class="fila">
      <div class="columna" id="sexo">
        <label>Sexo <span class="asterisco">*</span></label><br />
        <div style="display: flex; gap: 10px; align-items: center;">
          <input formControlName="sexo" type="radio" value="H" /> <label>Hombre</label>
          <input formControlName="sexo" type="radio" value="M" /> <label>Mujer</label>
        </div>
        @if (miFormulario.get('sexo')?.touched && miFormulario.get('sexo')?.invalid) {
          <p class="obligatorio" style="display: block;">El sexo es obligatorio</p>
        }
      </div>

      <div class="columna" id="archivo">
        <label for="dniFile" class="boton"> Subir DNI </label>
        <input id="dniFile" formControlName="dniFile" type="file" (change)="miFormulario.get('dniFile')?.markAsDirty()" />
        @if (miFormulario.get('dniFile')?.dirty && miFormulario.get('dniFile')?.invalid) {
          <p class="obligatorio" style="display: block;">Archivo no válido (png, jpg, gif)</p>
        }
      </div>
    </div>

    <div class="fila">
      <div class="columna" id="intereses">
        <label>Intereses</label>
        <select formControlName="interes" multiple="multiple">
          <option value="Arte">Arte</option>
          <option value="Literatura">Literatura</option>
          <option value="Música">Música</option>
          <option value="Cocina">Cocina</option>
        </select>
        @if (miFormulario.get('interes')?.touched && miFormulario.get('interes')?.invalid) {
          <p class="obligatorio" style="display: block;">Seleccione al menos un interés</p>
        }
      </div>

      <div class="columna">
        <label>Código Postal</label><br />
        <input class="caja" formControlName="CP" type="text" placeholder="NNNNN" maxlength="5" />
        @if (miFormulario.get('CP')?.touched && miFormulario.get('CP')?.invalid) {
          <p class="obligatorio" style="display: block;">El código postal debe ser válido</p>
        }
        <br />
        <label>Provincia</label><br />
        <input class="caja" type="text" [value]="provinciaCalculada()" readonly style="background-color: #eee;" />
      </div>
    </div>

    <div class="fila">
      <div class="columna" id="situacion">
        <label>Situación actual</label>
        <select formControlName="situacionSelect">
          <option value="" disabled selected>Seleccione una opción</option>
          <option value="Estudiante">Estudiante</option>
          <option value="En paro">En paro</option>
          <option value="Trabajando">Trabajando</option>
        </select>
        @if (miFormulario.get('situacionSelect')?.touched && miFormulario.get('situacionSelect')?.invalid) {
          <p class="obligatorio" style="display: block;">Debe seleccionar una situación</p>
        }
      </div>

      <div class="columna" id="acepto">
        <label>Acepto las condiciones
          @if(!miFormulario.get('checkboxAcepto')?.value) { <span class="asterisco">*</span> }
        </label>
        <input type="checkbox" formControlName="checkboxAcepto" />
        @if (miFormulario.get('checkboxAcepto')?.touched && miFormulario.get('checkboxAcepto')?.invalid) {
          <p class="obligatorio" style="display: block;">Debe aceptar las condiciones</p>
        }
      </div>
    </div>

    <div class="fila">
      <button class="boton" type="button" (click)="limpiarFormulario()">
        Limpiar
      </button>
    </div>

    <div class="fila">
      <button class="boton" id="enviar" type="submit" [disabled]="miFormulario.invalid">
        Enviar
      </button>
    </div>
  </form>
</div>

<router-outlet/>
